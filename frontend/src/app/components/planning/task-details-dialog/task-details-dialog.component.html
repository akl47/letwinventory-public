<div class="task-details-container">
    <h2 mat-dialog-title>
        {{ data.task.name }}
        <button mat-icon-button class="close-button" (click)="close()">
            <mat-icon>close</mat-icon>
        </button>
    </h2>

    <mat-dialog-content>
        <div class="task-info">
            <!-- List, Project, and Priority Chips -->
            <div class="info-section chips-row">
                <div class="chip-group">
                    <mat-chip [matMenuTriggerFor]="listMenu" color="primary">
                        {{ getCurrentListName() }}
                    </mat-chip>
                    <mat-menu #listMenu="matMenu">
                        <button mat-menu-item *ngFor="let list of taskLists" 
                                (click)="onListChange(list.id)"
                                [disabled]="list.id === data.task.taskListID">
                            {{ list.name }}
                        </button>
                    </mat-menu>
                </div>

                <div class="chip-group" *ngIf="data.task.projectID">
                    <mat-chip [matMenuTriggerFor]="projectMenu" 
                             [style.background-color]="getCurrentProjectColor()"
                             [style.color]="'white'">
                        {{ getCurrentProjectName() }}
                    </mat-chip>
                    <mat-menu #projectMenu="matMenu">
                        <button mat-menu-item *ngFor="let project of projects" 
                                (click)="onProjectChange(project.id)"
                                [disabled]="project.id === data.task.projectID">
                            {{ project.name }}
                        </button>
                    </mat-menu>
                </div>

                <div class="chip-group">
                    <mat-chip [matMenuTriggerFor]="priorityMenu" 
                             [color]="data.task.taskTypeEnum === TaskType.CRITICAL_PATH ? 'warn' : 
                                     (data.task.taskTypeEnum === TaskType.TRACKING ? 'accent' : 'primary')">
                        {{ data.task.taskTypeEnum }}
                    </mat-chip>
                    <mat-menu #priorityMenu="matMenu">
                        <button mat-menu-item 
                                (click)="onPriorityChange(TaskType.NORMAL)"
                                [disabled]="data.task.taskTypeEnum === TaskType.NORMAL">
                            Normal
                        </button>
                        <button mat-menu-item 
                                (click)="onPriorityChange(TaskType.TRACKING)"
                                [disabled]="data.task.taskTypeEnum === TaskType.TRACKING">
                            Tracking
                        </button>
                        <button mat-menu-item 
                                (click)="onPriorityChange(TaskType.CRITICAL_PATH)"
                                [disabled]="data.task.taskTypeEnum === TaskType.CRITICAL_PATH">
                            Critical Path
                        </button>
                    </mat-menu>
                </div>
            </div>

            <!-- Description -->
            <div class="info-section">
                <h3>Description</h3>
                <ng-container *ngIf="data.task.description; else descriptionInput">
                    <p>{{ data.task.description }}</p>
                </ng-container>
                <ng-template #descriptionInput>
                    <mat-form-field appearance="outline" class="description-input">
                        <mat-label>Add a description...</mat-label>
                        <textarea matInput
                                [(ngModel)]="description"
                                (blur)="onDescriptionChange()"
                                rows="3">
                        </textarea>
                    </mat-form-field>
                </ng-template>
            </div>
        </div>
    </mat-dialog-content>

    <mat-dialog-actions align="end">
        <button mat-button (click)="close()">Close</button>
    </mat-dialog-actions>
</div> 