<div class="toolbar">
  <!-- Tools -->
  <div class="toolbar-group">
    <button mat-icon-button
            matTooltip="Select (V)"
            [class.active]="activeTool() === 'select'"
            (click)="setTool('select')">
      <mat-icon>near_me</mat-icon>
    </button>
    <button mat-icon-button
            matTooltip="Pan (H)"
            [class.active]="activeTool() === 'pan'"
            (click)="setTool('pan')">
      <mat-icon>pan_tool</mat-icon>
    </button>
    <button mat-icon-button
            matTooltip="Draw Wire (W)"
            [class.active]="activeTool() === 'wire'"
            (click)="setTool('wire')">
      <mat-icon>cable</mat-icon>
    </button>
  </div>

  <mat-divider [vertical]="true"></mat-divider>

  <!-- Add elements -->
  <div class="toolbar-group">
    <button mat-icon-button matTooltip="Add Connector" (click)="addConnector.emit()">
      <mat-icon>add_box</mat-icon>
    </button>
    <button mat-icon-button matTooltip="Add Cable" (click)="addCable.emit()">
      <mat-icon>electrical_services</mat-icon>
    </button>
  </div>

  <mat-divider [vertical]="true"></mat-divider>

  <!-- Zoom controls -->
  <div class="toolbar-group">
    <button mat-icon-button matTooltip="Zoom In" (click)="zoomIn.emit()">
      <mat-icon>zoom_in</mat-icon>
    </button>
    <button mat-icon-button matTooltip="Zoom Out" (click)="zoomOut.emit()">
      <mat-icon>zoom_out</mat-icon>
    </button>
    <button mat-icon-button matTooltip="Reset Zoom" (click)="resetZoom.emit()">
      <mat-icon>fit_screen</mat-icon>
    </button>
    <span class="zoom-level">{{ zoomLevel() }}%</span>
  </div>

  <mat-divider [vertical]="true"></mat-divider>

  <!-- Grid settings -->
  <div class="toolbar-group">
    <mat-slide-toggle
      [checked]="gridEnabled()"
      (change)="gridEnabledChange.emit($event.checked)"
      matTooltip="Toggle Grid">
      Grid
    </mat-slide-toggle>
    <mat-slide-toggle
      [checked]="snapToGrid()"
      (change)="snapToGridChange.emit($event.checked)"
      matTooltip="Snap to Grid"
      [disabled]="!gridEnabled()">
      Snap
    </mat-slide-toggle>
  </div>

  <mat-divider [vertical]="true"></mat-divider>

  <!-- Edit operations -->
  <div class="toolbar-group">
    <button mat-icon-button
            matTooltip="Rotate 90Â° (R)"
            (click)="rotateConnector.emit()"
            [disabled]="!hasElementSelected()">
      <mat-icon>rotate_right</mat-icon>
    </button>
    <button mat-icon-button
            matTooltip="Mirror (F)"
            (click)="flipConnector.emit()"
            [disabled]="!hasElementSelected()">
      <mat-icon>flip</mat-icon>
    </button>
    <button mat-icon-button matTooltip="Delete Selected (Del)" (click)="deleteSelected.emit()">
      <mat-icon>delete</mat-icon>
    </button>
  </div>

  <mat-divider [vertical]="true"></mat-divider>

  <div class="toolbar-group">
    <button mat-icon-button [matMenuTriggerFor]="exportMenu" matTooltip="Export">
      <mat-icon>download</mat-icon>
    </button>
    <mat-menu #exportMenu="matMenu">
      <button mat-menu-item (click)="exportJSON.emit()">
        <mat-icon>code</mat-icon>
        <span>Export JSON</span>
      </button>
      <button mat-menu-item (click)="exportPNG.emit()">
        <mat-icon>image</mat-icon>
        <span>Export PNG</span>
      </button>
    </mat-menu>
    <button mat-icon-button matTooltip="Import JSON" (click)="importJSON.emit()">
      <mat-icon>upload</mat-icon>
    </button>
  </div>

  <!-- Spacer -->
  <div class="spacer"></div>

  <!-- Harness info -->
  <div class="harness-info" *ngIf="harnessName()">
    <span class="harness-name">{{ harnessName() }}</span>
    <span class="harness-revision" *ngIf="harnessPartNumber()">{{ harnessPartNumber() }}</span>
    <span class="harness-revision" *ngIf="harnessRevision()">Rev {{ harnessRevision() }}</span>
    @if (isSaving()) {
      <span class="saving-indicator">Saving...</span>
    } @else if (hasChanges()) {
      <span class="unsaved-indicator">*</span>
    } @else {
      <span class="saved-indicator">Saved</span>
    }
  </div>
</div>
